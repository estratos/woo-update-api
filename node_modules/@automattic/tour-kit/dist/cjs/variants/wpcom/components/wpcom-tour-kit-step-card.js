"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
const viewport_1 = require("@automattic/viewport");
const components_1 = require("@wordpress/components");
const icons_1 = require("@wordpress/icons");
const react_i18n_1 = require("@wordpress/react-i18n");
const classnames_1 = tslib_1.__importDefault(require("classnames"));
const wpcom_tour_kit_rating_1 = tslib_1.__importDefault(require("./wpcom-tour-kit-rating"));
const wpcom_tour_kit_step_card_navigation_1 = tslib_1.__importDefault(require("./wpcom-tour-kit-step-card-navigation"));
const wpcom_tour_kit_step_card_overlay_controls_1 = tslib_1.__importDefault(require("./wpcom-tour-kit-step-card-overlay-controls"));
const WpcomTourKitStepCard = ({ steps, currentStepIndex, onMinimize, onDismiss, onGoToStep, onNextStep, onPreviousStep, setInitialFocusedElement, }) => {
    const { __ } = (0, react_i18n_1.useI18n)();
    const lastStepIndex = steps.length - 1;
    const { descriptions, heading, imgSrc, imgLink } = steps[currentStepIndex].meta;
    const isLastStep = currentStepIndex === lastStepIndex;
    const description = descriptions[(0, viewport_1.isMobile)() ? 'mobile' : 'desktop'] ?? descriptions.desktop;
    // @todo check why the assertion is needed here to pass TS
    const mediaQueryList = (0, viewport_1.getMediaQueryList)(viewport_1.MOBILE_BREAKPOINT);
    return ((0, jsx_runtime_1.jsxs)(components_1.Card, { className: "wpcom-tour-kit-step-card", isElevated: true, children: [(0, jsx_runtime_1.jsx)(wpcom_tour_kit_step_card_overlay_controls_1.default, { onDismiss: onDismiss, onMinimize: onMinimize }), imgSrc && ((0, jsx_runtime_1.jsxs)(components_1.CardMedia, { className: "wpcom-tour-kit-step-card__media", children: [(0, jsx_runtime_1.jsxs)("picture", { children: [imgSrc.mobile && ((0, jsx_runtime_1.jsx)("source", { srcSet: imgSrc.mobile.src, type: imgSrc.mobile.type, media: mediaQueryList?.media })), (0, jsx_runtime_1.jsx)("img", { alt: __('Tour Media', __i18n_text_domain__), src: imgSrc.desktop?.src })] }), imgLink && ((0, jsx_runtime_1.jsx)("a", { className: (0, classnames_1.default)('wpcom-tour-kit-step-card__media-link', {
                            'wpcom-tour-kit-step-card__media-link--playable': imgLink.playable,
                        }), href: imgLink.href, target: "_blank", rel: "noreferrer noopener", onClick: imgLink.onClick, children: (0, jsx_runtime_1.jsx)(icons_1.Icon, { icon: (0, jsx_runtime_1.jsx)("svg", { width: "27", height: "32", viewBox: "0 0 27 32", fill: "none", xmlns: "http://www.w3.org/2000/svg", children: (0, jsx_runtime_1.jsx)("path", { d: "M27 16L-1.4682e-06 31.5885L-1.05412e-07 0.411542L27 16Z", fill: "white" }) }), size: 27 }) }))] })), (0, jsx_runtime_1.jsxs)(components_1.CardBody, { children: [(0, jsx_runtime_1.jsx)("h2", { className: "wpcom-tour-kit-step-card__heading", children: heading }), (0, jsx_runtime_1.jsxs)("p", { className: "wpcom-tour-kit-step-card__description", children: [description, isLastStep ? ((0, jsx_runtime_1.jsx)(components_1.Button, { className: "wpcom-tour-kit-step-card__description", variant: "tertiary", onClick: () => onGoToStep(0), ref: setInitialFocusedElement, children: __('Restart tour', __i18n_text_domain__) })) : null] })] }), (0, jsx_runtime_1.jsx)(components_1.CardFooter, { children: isLastStep ? ((0, jsx_runtime_1.jsx)(wpcom_tour_kit_rating_1.default, {})) : ((0, jsx_runtime_1.jsx)(wpcom_tour_kit_step_card_navigation_1.default, { currentStepIndex: currentStepIndex, onDismiss: onDismiss, onGoToStep: onGoToStep, onNextStep: onNextStep, onPreviousStep: onPreviousStep, setInitialFocusedElement: setInitialFocusedElement, steps: steps })) })] }));
};
exports.default = WpcomTourKitStepCard;
//# sourceMappingURL=wpcom-tour-kit-step-card.js.map