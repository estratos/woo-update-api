"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const jsx_runtime_1 = require("react/jsx-runtime");
const components_1 = require("@wordpress/components");
const element_1 = require("@wordpress/element");
const react_i18n_1 = require("@wordpress/react-i18n");
const classnames_1 = tslib_1.__importDefault(require("classnames"));
const index_1 = require("../../../index");
const thumbs_down_1 = tslib_1.__importDefault(require("../icons/thumbs_down"));
const thumbs_up_1 = tslib_1.__importDefault(require("../icons/thumbs_up"));
const WpcomTourKitRating = () => {
    const [tempRating, setTempRating] = (0, element_1.useState)();
    const context = (0, index_1.useTourKitContext)();
    const config = context.config;
    const tourRating = config.options?.tourRating?.useTourRating?.() ?? tempRating;
    const { __ } = (0, react_i18n_1.useI18n)();
    let isDisabled = false;
    if (!config.options?.tourRating?.enabled) {
        return null;
    }
    // check is on tempRating to allow rerating in a restarted tour
    if (!isDisabled && tempRating !== undefined) {
        isDisabled = true;
    }
    const rateTour = (isThumbsUp) => {
        if (isDisabled) {
            return;
        }
        const rating = isThumbsUp ? 'thumbs-up' : 'thumbs-down';
        if (rating !== tourRating) {
            isDisabled = true;
            setTempRating(rating);
            config.options?.tourRating?.onTourRate?.(rating);
        }
    };
    return ((0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [(0, jsx_runtime_1.jsx)("p", { className: "wpcom-tour-kit-rating__end-text", children: __('Did you find this guide helpful?', __i18n_text_domain__) }), (0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)(components_1.Button, { "aria-label": __('Rate thumbs up', __i18n_text_domain__), className: (0, classnames_1.default)('wpcom-tour-kit-rating__end-icon', {
                            active: tourRating === 'thumbs-up',
                        }), disabled: isDisabled, icon: thumbs_up_1.default, onClick: () => rateTour(true), iconSize: 24 }), (0, jsx_runtime_1.jsx)(components_1.Button, { "aria-label": __('Rate thumbs down', __i18n_text_domain__), className: (0, classnames_1.default)('wpcom-tour-kit-rating__end-icon', {
                            active: tourRating === 'thumbs-down',
                        }), disabled: isDisabled, icon: thumbs_down_1.default, onClick: () => rateTour(false), iconSize: 24 })] })] }));
};
exports.default = WpcomTourKitRating;
//# sourceMappingURL=wpcom-tour-kit-rating.js.map