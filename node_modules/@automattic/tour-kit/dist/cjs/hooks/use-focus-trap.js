"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * External Dependencies
 */
const dom_1 = require("@wordpress/dom");
const element_1 = require("@wordpress/element");
/**
 * A hook that constraints tabbing/focus on focuable elements in the given element ref.
 * @param ref React.MutableRefObject< null | HTMLElement >
 */
const useFocusTrap = (ref) => {
    const [firstFocusableElement, setFirstFocusableElement] = (0, element_1.useState)();
    const [lastFocusableElement, setLastFocusableElement] = (0, element_1.useState)();
    const handleTrapFocus = (0, element_1.useCallback)((event) => {
        let handled = false;
        if (event.key === 'Tab') {
            if (event.shiftKey) {
                // Shift + Tab
                if (document.activeElement === firstFocusableElement) {
                    lastFocusableElement?.focus();
                    handled = true;
                }
            }
            else if (document.activeElement === lastFocusableElement) {
                // Tab
                firstFocusableElement?.focus();
                handled = true;
            }
        }
        if (handled) {
            event.preventDefault();
            event.stopPropagation();
        }
    }, [firstFocusableElement, lastFocusableElement]);
    (0, element_1.useEffect)(() => {
        const focusableElements = ref.current ? dom_1.focus.focusable.find(ref.current) : [];
        if (focusableElements && focusableElements.length) {
            setFirstFocusableElement(focusableElements[0]);
            setLastFocusableElement(focusableElements[focusableElements.length - 1]);
        }
        document.addEventListener('keydown', handleTrapFocus);
        return () => {
            document.removeEventListener('keydown', handleTrapFocus);
        };
    }, [ref, handleTrapFocus]);
};
exports.default = useFocusTrap;
//# sourceMappingURL=use-focus-trap.js.map