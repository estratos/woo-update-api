"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getReportStats = exports.getReportItems = void 0;
/**
 * External dependencies
 */
const url_1 = require("@wordpress/url");
/**
 * Internal dependencies
 */
const controls_1 = require("../controls");
const constants_1 = require("../constants");
const actions_1 = require("./actions");
function* getReportItems(endpoint, query) {
    const fetchArgs = {
        parse: false,
        path: (0, url_1.addQueryArgs)(`${constants_1.NAMESPACE}/reports/${endpoint}`, query),
    };
    try {
        const response = yield (0, controls_1.fetchWithHeaders)(fetchArgs);
        const data = response.data;
        const totalResults = parseInt(response.headers.get('x-wp-total'), 10);
        const totalPages = parseInt(response.headers.get('x-wp-totalpages'), 10);
        yield (0, actions_1.setReportItems)(endpoint, query, {
            data,
            totalResults,
            totalPages,
        });
    }
    catch (error) {
        yield (0, actions_1.setReportItemsError)(endpoint, query, error);
    }
}
exports.getReportItems = getReportItems;
function* getReportStats(endpoint, query) {
    const fetchArgs = {
        parse: false,
        path: (0, url_1.addQueryArgs)(`${constants_1.NAMESPACE}/reports/${endpoint}/stats`, query),
    };
    try {
        const response = yield (0, controls_1.fetchWithHeaders)(fetchArgs);
        const data = response.data;
        const totalResults = parseInt(response.headers.get('x-wp-total'), 10);
        const totalPages = parseInt(response.headers.get('x-wp-totalpages'), 10);
        yield (0, actions_1.setReportStats)(endpoint, query, {
            data,
            totalResults,
            totalPages,
        });
    }
    catch (error) {
        yield (0, actions_1.setReportStatsError)(endpoint, query, error);
    }
}
exports.getReportStats = getReportStats;
