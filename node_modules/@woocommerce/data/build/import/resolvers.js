"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getImportTotals = exports.getImportStatus = void 0;
/**
 * External dependencies
 */
const url_1 = require("@wordpress/url");
const data_controls_1 = require("@wordpress/data-controls");
const lodash_1 = require("lodash");
/**
 * Internal dependencies
 */
const constants_1 = require("../constants");
const actions_1 = require("./actions");
function* getImportStatus(query) {
    try {
        const url = (0, url_1.addQueryArgs)(`${constants_1.NAMESPACE}/reports/import/status`, typeof query === 'object' ? (0, lodash_1.omit)(query, ['timestamp']) : {});
        const response = yield (0, data_controls_1.apiFetch)({ path: url });
        yield (0, actions_1.setImportStatus)(query, response);
    }
    catch (error) {
        yield (0, actions_1.setImportError)(query, error);
    }
}
exports.getImportStatus = getImportStatus;
function* getImportTotals(query) {
    try {
        const url = (0, url_1.addQueryArgs)(`${constants_1.NAMESPACE}/reports/import/totals`, query);
        const response = yield (0, data_controls_1.apiFetch)({ path: url });
        yield (0, actions_1.setImportTotals)(query, response);
    }
    catch (error) {
        yield (0, actions_1.setImportError)(query, error);
    }
}
exports.getImportTotals = getImportTotals;
