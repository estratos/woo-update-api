"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getProductTypes = exports.getFreeExtensions = exports.getPaymentGatewaySuggestions = exports.getTask = exports.getTaskList = exports.getTaskListsByIds = exports.getTaskLists = exports.getEmailPrefill = exports.getProfileItems = void 0;
/**
 * External dependencies
 */
const data_controls_1 = require("@wordpress/data-controls");
const data_1 = require("@wordpress/data");
/**
 * Internal dependencies
 */
const constants_1 = require("./constants");
const constants_2 = require("../constants");
const actions_1 = require("./actions");
const deprecated_tasks_1 = require("./deprecated-tasks");
const resolveSelect = data_1.controls && data_1.controls.resolveSelect ? data_1.controls.resolveSelect : data_controls_1.select;
function* getProfileItems() {
    try {
        const results = yield (0, data_controls_1.apiFetch)({
            path: constants_2.WC_ADMIN_NAMESPACE + '/onboarding/profile',
            method: 'GET',
        });
        yield (0, actions_1.setProfileItems)(results, true);
    }
    catch (error) {
        yield (0, actions_1.setError)('getProfileItems', error);
    }
}
exports.getProfileItems = getProfileItems;
function* getEmailPrefill() {
    try {
        const results = yield (0, data_controls_1.apiFetch)({
            path: constants_2.WC_ADMIN_NAMESPACE +
                '/onboarding/profile/experimental_get_email_prefill',
            method: 'GET',
        });
        yield (0, actions_1.setEmailPrefill)(results.email);
    }
    catch (error) {
        yield (0, actions_1.setError)('getEmailPrefill', error);
    }
}
exports.getEmailPrefill = getEmailPrefill;
function* getTaskLists() {
    const deprecatedTasks = new deprecated_tasks_1.DeprecatedTasks();
    try {
        const results = yield (0, data_controls_1.apiFetch)({
            path: constants_2.WC_ADMIN_NAMESPACE + '/onboarding/tasks',
            method: deprecatedTasks.hasDeprecatedTasks() ? 'POST' : 'GET',
            data: deprecatedTasks.getPostData(),
        });
        deprecatedTasks.mergeDeprecatedCallbackFunctions(results);
        yield (0, actions_1.getTaskListsSuccess)(results);
    }
    catch (error) {
        yield (0, actions_1.getTaskListsError)(error);
    }
}
exports.getTaskLists = getTaskLists;
function* getTaskListsByIds() {
    yield resolveSelect(constants_1.STORE_NAME, 'getTaskLists');
}
exports.getTaskListsByIds = getTaskListsByIds;
function* getTaskList() {
    yield resolveSelect(constants_1.STORE_NAME, 'getTaskLists');
}
exports.getTaskList = getTaskList;
function* getTask() {
    yield resolveSelect(constants_1.STORE_NAME, 'getTaskLists');
}
exports.getTask = getTask;
function* getPaymentGatewaySuggestions() {
    try {
        const results = yield (0, data_controls_1.apiFetch)({
            path: constants_2.WC_ADMIN_NAMESPACE + '/payment-gateway-suggestions',
            method: 'GET',
        });
        yield (0, actions_1.setPaymentMethods)(results);
    }
    catch (error) {
        yield (0, actions_1.setError)('getPaymentGatewaySuggestions', error);
    }
}
exports.getPaymentGatewaySuggestions = getPaymentGatewaySuggestions;
function* getFreeExtensions() {
    try {
        const results = yield (0, data_controls_1.apiFetch)({
            path: constants_2.WC_ADMIN_NAMESPACE + '/onboarding/free-extensions',
            method: 'GET',
        });
        yield (0, actions_1.getFreeExtensionsSuccess)(results);
    }
    catch (error) {
        yield (0, actions_1.getFreeExtensionsError)(error);
    }
}
exports.getFreeExtensions = getFreeExtensions;
function* getProductTypes() {
    try {
        const results = yield (0, data_controls_1.apiFetch)({
            path: constants_2.WC_ADMIN_NAMESPACE + '/onboarding/product-types',
            method: 'GET',
        });
        yield (0, actions_1.getProductTypesSuccess)(results);
    }
    catch (error) {
        yield (0, actions_1.getProductTypesError)(error);
    }
}
exports.getProductTypes = getProductTypes;
