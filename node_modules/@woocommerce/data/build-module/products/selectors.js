/**
 * External dependencies
 */
import createSelector from 'rememo';
/**
 * Internal dependencies
 */
import { getProductResourceName, getTotalProductCountResourceName, } from './utils';
export const getProducts = createSelector((state, query, defaultValue = undefined) => {
    const resourceName = getProductResourceName(query);
    const ids = state.products[resourceName]
        ? state.products[resourceName].data
        : undefined;
    if (!ids) {
        return defaultValue;
    }
    if (query._fields) {
        return ids.map((id) => {
            return query._fields.reduce((product, field) => {
                return {
                    ...product,
                    [field]: state.data[id][field],
                };
            }, {});
        });
    }
    return ids.map((id) => {
        return state.data[id];
    });
}, (state, query) => {
    const resourceName = getProductResourceName(query);
    const ids = state.products[resourceName]
        ? state.products[resourceName].data
        : undefined;
    return [
        state.products[resourceName],
        ...(ids || []).map((id) => {
            return state.data[id];
        }),
    ];
});
export const getProductsTotalCount = (state, query, defaultValue = undefined) => {
    const resourceName = getTotalProductCountResourceName(query);
    const totalCount = state.productsCount.hasOwnProperty(resourceName)
        ? state.productsCount[resourceName]
        : defaultValue;
    return totalCount;
};
export const getProductsError = (state, query) => {
    const resourceName = getProductResourceName(query);
    return state.errors[resourceName];
};
export const getCreateProductError = (state, query) => {
    const resourceName = getProductResourceName(query);
    return state.errors[resourceName];
};
export const getUpdateProductError = (state, id, query) => {
    const resourceName = getProductResourceName(query);
    return state.errors[`update/${id}/${resourceName}`];
};
export const getDeleteProductError = (state, id) => {
    return state.errors[`delete/${id}`];
};
